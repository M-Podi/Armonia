// scss/galerie-animata.scss

// --- Default Variables (will be overridden by Node.js) ---
$numar-imagini: 4 !default; // Default number of images if not provided
$slide-duration: 4s !default; // Duration each slide is fully visible + transition
$transition-percentage: 15%; // Percentage of slide duration for fade/clip transition (e.g., 15% = 0.6s for 4s slide)

// --- Calculated Variables ---
$total-animation-duration: $numar-imagini * $slide-duration;
$border-thickness: 15px; // Adjust border thickness
$border-image-slice: 40; // Adjust border image slicing

#galerie-animata-container {
  display: block; // Initially visible on large screens
  margin: 2em auto;
  max-width: 700px; // Adjust max width as needed
  aspect-ratio: 16 / 9; // Maintain aspect ratio
  position: relative;
  overflow: hidden; // Hide parts of images outside the container

  // --- Border Image ---
  border: $border-thickness solid transparent;
  // IMPORTANT: Replace 'border-texture.png' with your actual image file name
  // Make sure this texture exists in 'public/resources/textures/'
  border-image-source: url('/resources/textures/border-texture.png');
  border-image-slice: $border-image-slice;
  border-image-width: $border-thickness;
  border-image-outset: 0;
  border-image-repeat: stretch; // or round, repeat

  // --- Pause on Hover ---
  &:hover .imagini-animatie {
    animation-play-state: paused;
  }
}

.imagini-animatie {
  position: relative;
  width: 100%;
  height: 100%;
}

.slide-img-animat {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover; // Cover the container without distortion
  opacity: 0; // Start hidden
  // Start clipped vertically from center
  clip-path: inset(50% 0 50% 0);
  // Apply the animation - properties will be set per child
  animation-name: galerie-clip-reveal-hide;
  animation-timing-function: linear; // Use linear for smooth transitions between keyframes
  animation-iteration-count: infinite;
  animation-duration: $total-animation-duration;
  animation-fill-mode: forwards; // Keep the state of the last keyframe (though infinite loops)

  // --- Dynamic Animation Delay per Image ---
  @for $i from 1 through $numar-imagini {
    &:nth-child(#{$i}) {
      // Calculate the delay for this specific image
      $delay: ($i - 1) * $slide-duration;
      animation-delay: $delay;
    }
  }
}

// --- Keyframe Animation ---
@keyframes galerie-clip-reveal-hide {
  // Start: Image becomes active (opacity 1), starts revealing
  0% {
    opacity: 1;
    clip-path: inset(50% 0 50% 0); // Clipped
  }
  // Reveal phase
  #{$transition-percentage} {
    opacity: 1;
    clip-path: inset(0% 0 0% 0); // Fully revealed
  }
  // Fully visible phase (duration calculated based on total time and number of images)
  #{100% / $numar-imagini - $transition-percentage} {
    opacity: 1;
    clip-path: inset(0% 0 0% 0); // Stays fully visible
  }
  // Start hiding phase
  #{100% / $numar-imagini} {
    opacity: 0; // Fade out while clipping
    clip-path: inset(50% 0 50% 0); // Clip back to center
  }
  // Remainder of the time (until next image starts): Stay hidden
  100% {
    opacity: 0;
    clip-path: inset(50% 0 50% 0);
  }
}

// --- Responsive Hiding ---
// Hide gallery on medium and small screens (adjust breakpoint as needed)
@media (max-width: 992px) { // Example breakpoint for medium/small
  #galerie-animata-container {
    display: none;
  }
}